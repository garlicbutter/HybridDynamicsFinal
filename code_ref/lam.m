function [vt,lambt,lambn, lam_n, lam_ndot]=lam(X,sigma,tau)

m=0.3;
g=10;
l=0.15;
mu=0.3;

x=X(1);y=X(2);theta1=X(3);theta2=X(4);
xd=X(5);yd=X(6);theta1d=X(7);theta2d=X(8);
%% general
vt=xd + 2.*l.*theta1d.*sin(theta1);
% lambt=(21.*tau.*sin(theta1 + theta2) - 27.*tau.*sin(theta1 - theta2) + 10.*l.^2.*m.*theta1d.^2.*cos(theta1 + theta2) + 10.*l.^2.*m.*theta2d.^2.*cos(theta1 + theta2) + 3.*g.*l.*m.*sin(2.*theta1 + 2.*theta2) + 90.*l.^2.*m.*theta1d.^2.*cos(theta1) + 18.*l.^2.*m.*theta1d.^2.*cos(theta1 - theta2) - 6.*l.^2.*m.*theta1d.^2.*cos(theta1 + 2.*theta2) + 18.*l.^2.*m.*theta2d.^2.*cos(theta1 - theta2) - 27.*g.*l.*m.*sin(2.*theta1) + 20.*l.^2.*m.*theta1d.*theta2d.*cos(theta1 + theta2) + 36.*l.^2.*m.*theta1d.*theta2d.*cos(theta1 - theta2))/(2.*l.*(9.*cos(2.*theta2) - 23));
% lambn=(27.*tau.*cos(theta1 - theta2) - 21.*tau.*cos(theta1 + theta2) - 41.*g.*l.*m - 3.*g.*l.*m.*cos(2.*theta1 + 2.*theta2) + 10.*l.^2.*m.*theta1d.^2.*sin(theta1 + theta2) + 10.*l.^2.*m.*theta2d.^2.*sin(theta1 + theta2) + 90.*l.^2.*m.*theta1d.^2.*sin(theta1) + 18.*l.^2.*m.*theta1d.^2.*sin(theta1 - theta2) - 6.*l.^2.*m.*theta1d.^2.*sin(theta1 + 2.*theta2) + 18.*l.^2.*m.*theta2d.^2.*sin(theta1 - theta2) + 27.*g.*l.*m.*cos(2.*theta1) + 9.*g.*l.*m.*cos(2.*theta2) + 20.*l.^2.*m.*theta1d.*theta2d.*sin(theta1 + theta2) + 36.*l.^2.*m.*theta1d.*theta2d.*sin(theta1 - theta2))/(2.*l.*(9.*cos(2.*theta2) - 23));

lambt=(3*m*(((3*(8*cos(theta1 + theta2) + 8*cos(theta1) - 3*cos(theta1 + theta2)*sin(theta1)^2 - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1) + 3*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) - (12*l*cos(theta1)*(3*sin(theta1 + theta2)*sin(theta1) - 3*cos(theta1 + theta2)^2 - 3*sin(theta1 + theta2)^2 + 3*cos(theta1 + theta2)*cos(theta1) + 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(tau - g*l*m*cos(theta1 + theta2)) - (2*g*m - l*m*(theta1d^2*sin(theta1 + theta2) - theta1d^2*sin(theta1) + theta2d^2*sin(theta1 + theta2) + 2*theta1d*theta2d*sin(theta1 + theta2)))*((4*(3*sin(theta1 + theta2)^2 + 3*sin(theta1)^2 - 8))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) + (6*l*cos(theta1)*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))) + 2*l*theta1d^2*sin(theta1) + l*m*((12*(cos(theta1)*sin(theta1) + cos(theta1 + theta2)*sin(theta1 + theta2)))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) - (6*l*cos(theta1)*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(theta1d^2*cos(theta1 + theta2) - theta1d^2*cos(theta1) + theta2d^2*cos(theta1 + theta2) + 2*theta1d*theta2d*cos(theta1 + theta2)) + g*l*m*(cos(theta1 + theta2) - cos(theta1))*((3*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) + (12*l*cos(theta1)*(3*cos(theta1 + theta2)^2 + 3*sin(theta1 + theta2)^2 - 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))))*(3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)^2 - 2*cos(theta1 + theta2)*sin(theta1 + theta2) - 18*cos(theta1)*sin(theta1) + 9*cos(theta1 + theta2)^2*cos(theta1)*sin(theta1) + 9*sin(theta1 + theta2)^2*cos(theta1)*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)^2))/(2*(12*cos(theta1)^2 + 12*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*cos(theta1)^2 - 9*sin(theta1 + theta2)^2*sin(theta1)^2 - 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) + 4)) - (m*(((3*(8*sin(theta1 + theta2) + 8*sin(theta1) - 3*sin(theta1 + theta2)*cos(theta1)^2 - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1) + 3*cos(theta1 + theta2)*cos(theta1)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) - (12*l*sin(theta1)*(3*sin(theta1 + theta2)*sin(theta1) - 3*cos(theta1 + theta2)^2 - 3*sin(theta1 + theta2)^2 + 3*cos(theta1 + theta2)*cos(theta1) + 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(tau - g*l*m*cos(theta1 + theta2)) + (2*g*m - l*m*(theta1d^2*sin(theta1 + theta2) - theta1d^2*sin(theta1) + theta2d^2*sin(theta1 + theta2) + 2*theta1d*theta2d*sin(theta1 + theta2)))*((12*(cos(theta1)*sin(theta1) + cos(theta1 + theta2)*sin(theta1 + theta2)))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) - (6*l*sin(theta1)*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))) - 2*l*theta1d^2*cos(theta1) - l*m*((4*(3*cos(theta1 + theta2)^2 + 3*cos(theta1)^2 - 8))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) + (6*l*sin(theta1)*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(theta1d^2*cos(theta1 + theta2) - theta1d^2*cos(theta1) + theta2d^2*cos(theta1 + theta2) + 2*theta1d*theta2d*cos(theta1 + theta2)) + g*l*m*(cos(theta1 + theta2) - cos(theta1))*((3*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) + (12*l*sin(theta1)*(3*cos(theta1 + theta2)^2 + 3*sin(theta1 + theta2)^2 - 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))))*(3*sin(theta1 + theta2)^2 - 24*cos(theta1)^2 + 3*sin(theta1)^2 + 18*cos(theta1 + theta2)^2*cos(theta1)^2 + 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 9*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 8))/(12*cos(theta1)^2 + 12*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*cos(theta1)^2 - 9*sin(theta1 + theta2)^2*sin(theta1)^2 - 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) + 4);
lambn=(m*(((3*(8*cos(theta1 + theta2) + 8*cos(theta1) - 3*cos(theta1 + theta2)*sin(theta1)^2 - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1) + 3*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) - (12*l*cos(theta1)*(3*sin(theta1 + theta2)*sin(theta1) - 3*cos(theta1 + theta2)^2 - 3*sin(theta1 + theta2)^2 + 3*cos(theta1 + theta2)*cos(theta1) + 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(tau - g*l*m*cos(theta1 + theta2)) - (2*g*m - l*m*(theta1d^2*sin(theta1 + theta2) - theta1d^2*sin(theta1) + theta2d^2*sin(theta1 + theta2) + 2*theta1d*theta2d*sin(theta1 + theta2)))*((4*(3*sin(theta1 + theta2)^2 + 3*sin(theta1)^2 - 8))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) + (6*l*cos(theta1)*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))) + 2*l*theta1d^2*sin(theta1) + l*m*((12*(cos(theta1)*sin(theta1) + cos(theta1 + theta2)*sin(theta1 + theta2)))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) - (6*l*cos(theta1)*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(theta1d^2*cos(theta1 + theta2) - theta1d^2*cos(theta1) + theta2d^2*cos(theta1 + theta2) + 2*theta1d*theta2d*cos(theta1 + theta2)) + g*l*m*(cos(theta1 + theta2) - cos(theta1))*((3*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) + (12*l*cos(theta1)*(3*cos(theta1 + theta2)^2 + 3*sin(theta1 + theta2)^2 - 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))))*(3*cos(theta1 + theta2)^2 + 3*cos(theta1)^2 - 24*sin(theta1)^2 + 9*cos(theta1 + theta2)^2*sin(theta1)^2 + 18*sin(theta1 + theta2)^2*sin(theta1)^2 + 9*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 8))/(12*cos(theta1)^2 + 12*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*cos(theta1)^2 - 9*sin(theta1 + theta2)^2*sin(theta1)^2 - 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) + 4) - (3*m*(((3*(8*sin(theta1 + theta2) + 8*sin(theta1) - 3*sin(theta1 + theta2)*cos(theta1)^2 - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1) + 3*cos(theta1 + theta2)*cos(theta1)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) - (12*l*sin(theta1)*(3*sin(theta1 + theta2)*sin(theta1) - 3*cos(theta1 + theta2)^2 - 3*sin(theta1 + theta2)^2 + 3*cos(theta1 + theta2)*cos(theta1) + 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(tau - g*l*m*cos(theta1 + theta2)) + (2*g*m - l*m*(theta1d^2*sin(theta1 + theta2) - theta1d^2*sin(theta1) + theta2d^2*sin(theta1 + theta2) + 2*theta1d*theta2d*sin(theta1 + theta2)))*((12*(cos(theta1)*sin(theta1) + cos(theta1 + theta2)*sin(theta1 + theta2)))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) - (6*l*sin(theta1)*(8*cos(theta1) - 3*sin(theta1 + theta2)^2*cos(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))) - 2*l*theta1d^2*cos(theta1) - l*m*((4*(3*cos(theta1 + theta2)^2 + 3*cos(theta1)^2 - 8))/(m*(24*cos(theta1 + theta2)^2 + 24*sin(theta1 + theta2)^2 + 24*cos(theta1)^2 + 24*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) - 64)) + (6*l*sin(theta1)*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))))*(theta1d^2*cos(theta1 + theta2) - theta1d^2*cos(theta1) + theta2d^2*cos(theta1 + theta2) + 2*theta1d*theta2d*cos(theta1 + theta2)) + g*l*m*(cos(theta1 + theta2) - cos(theta1))*((3*(8*sin(theta1) - 3*cos(theta1 + theta2)^2*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)))/(m*(24*l*cos(theta1)^2 - 64*l + 24*l*sin(theta1)^2 + 24*l*cos(theta1 + theta2)^2 + 24*l*sin(theta1 + theta2)^2 - 9*l*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1))) + (12*l*sin(theta1)*(3*cos(theta1 + theta2)^2 + 3*sin(theta1 + theta2)^2 - 8))/(m*(24*l^2*cos(theta1 + theta2)^2 + 24*l^2*sin(theta1 + theta2)^2 + 24*l^2*cos(theta1)^2 + 24*l^2*sin(theta1)^2 - 64*l^2 - 9*l^2*cos(theta1 + theta2)^2*sin(theta1)^2 - 9*l^2*sin(theta1 + theta2)^2*cos(theta1)^2 + 18*l^2*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1)))))*(3*cos(theta1 + theta2)*sin(theta1 + theta2)*sin(theta1)^2 - 2*cos(theta1 + theta2)*sin(theta1 + theta2) - 18*cos(theta1)*sin(theta1) + 9*cos(theta1 + theta2)^2*cos(theta1)*sin(theta1) + 9*sin(theta1 + theta2)^2*cos(theta1)*sin(theta1) + 3*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)^2))/(2*(12*cos(theta1)^2 + 12*sin(theta1)^2 - 9*cos(theta1 + theta2)^2*cos(theta1)^2 - 9*sin(theta1 + theta2)^2*sin(theta1)^2 - 18*cos(theta1 + theta2)*sin(theta1 + theta2)*cos(theta1)*sin(theta1) + 4));

%% slipping
theta1dd=(42*l^2*m*theta1d^2*sin(theta2) - 9*tau*cos(2*theta1 + 2*theta2) - 45*tau*cos(theta2) - 27*tau*cos(2*theta1 + theta2) - 9*mu*sigma*tau*sin(2*theta1 + 2*theta2) - 39*tau + 42*l^2*m*theta2d^2*sin(theta2) - 81*g*l*m*cos(theta1) + 18*l^2*m*theta1d^2*sin(2*theta1 + theta2) + 18*l^2*m*theta2d^2*sin(2*theta1 + theta2) + 27*mu*sigma*tau*sin(theta2) + 9*g*l*m*cos(theta1 + 2*theta2) + 54*l^2*m*theta1d^2*sin(2*theta1) + 18*l^2*m*theta1d^2*sin(2*theta2) - 27*mu*sigma*tau*sin(2*theta1 + theta2) + 54*l^2*m*mu*sigma*theta1d^2 + 84*l^2*m*theta1d*theta2d*sin(theta2) + 36*l^2*m*theta1d*theta2d*sin(2*theta1 + theta2) + 18*l^2*m*mu*sigma*theta1d^2*cos(theta2) + 18*l^2*m*mu*sigma*theta2d^2*cos(theta2) - 18*l^2*m*mu*sigma*theta1d^2*cos(2*theta1 + theta2) - 18*l^2*m*mu*sigma*theta2d^2*cos(2*theta1 + theta2) - 81*g*l*m*mu*sigma*sin(theta1) - 54*l^2*m*mu*sigma*theta1d^2*cos(2*theta1) + 9*g*l*m*mu*sigma*sin(theta1 + 2*theta2) + 36*l^2*m*mu*sigma*theta1d*theta2d*cos(theta2) - 36*l^2*m*mu*sigma*theta1d*theta2d*cos(2*theta1 + theta2))/(2*l^2*m*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41));
theta2dd=-(3*g*l*m*cos(theta1 + theta2) - 81*tau*cos(2*theta1) - 9*tau*cos(2*theta1 + 2*theta2) - 90*tau*cos(theta2) - 54*tau*cos(2*theta1 + theta2) - 9*mu*sigma*tau*sin(2*theta1 + 2*theta2) - 150*tau + 120*l^2*m*theta1d^2*sin(theta2) + 42*l^2*m*theta2d^2*sin(theta2) - 81*g*l*m*cos(theta1) + 36*l^2*m*theta1d^2*sin(2*theta1 + theta2) + 18*l^2*m*theta2d^2*sin(2*theta1 + theta2) - 27*g*l*m*cos(theta1 - theta2) + 9*g*l*m*cos(theta1 + 2*theta2) + 54*l^2*m*theta1d^2*sin(2*theta1) + 36*l^2*m*theta1d^2*sin(2*theta2) + 18*l^2*m*theta2d^2*sin(2*theta2) - 54*mu*sigma*tau*sin(2*theta1 + theta2) + 6*l^2*m*theta1d^2*sin(2*theta1 + 2*theta2) + 6*l^2*m*theta2d^2*sin(2*theta1 + 2*theta2) - 81*mu*sigma*tau*sin(2*theta1) + 60*l^2*m*mu*sigma*theta1d^2 + 6*l^2*m*mu*sigma*theta2d^2 + 84*l^2*m*theta1d*theta2d*sin(theta2) + 36*l^2*m*theta1d*theta2d*sin(2*theta1 + theta2) + 36*l^2*m*theta1d*theta2d*sin(2*theta2) + 12*l^2*m*theta1d*theta2d*sin(2*theta1 + 2*theta2) + 36*l^2*m*mu*sigma*theta1d^2*cos(theta2) + 18*l^2*m*mu*sigma*theta2d^2*cos(theta2) + 3*g*l*m*mu*sigma*sin(theta1 + theta2) - 36*l^2*m*mu*sigma*theta1d^2*cos(2*theta1 + theta2) - 18*l^2*m*mu*sigma*theta2d^2*cos(2*theta1 + theta2) + 12*l^2*m*mu*sigma*theta1d*theta2d - 81*g*l*m*mu*sigma*sin(theta1) - 54*l^2*m*mu*sigma*theta1d^2*cos(2*theta1) - 27*g*l*m*mu*sigma*sin(theta1 - theta2) + 9*g*l*m*mu*sigma*sin(theta1 + 2*theta2) - 6*l^2*m*mu*sigma*theta1d^2*cos(2*theta1 + 2*theta2) - 6*l^2*m*mu*sigma*theta2d^2*cos(2*theta1 + 2*theta2) + 36*l^2*m*mu*sigma*theta1d*theta2d*cos(theta2) - 36*l^2*m*mu*sigma*theta1d*theta2d*cos(2*theta1 + theta2) - 12*l^2*m*mu*sigma*theta1d*theta2d*cos(2*theta1 + 2*theta2))/(2*l^2*m*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41));

lam_n=(3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41));

lam_ndot=theta2d*((2*l^2*m*theta1d^2*cos(theta1 + theta2) - 27*tau*sin(theta1 - theta2) - 18*tau*sin(theta1 + 2*theta2) - 3*tau*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*cos(theta1 + theta2) + 18*l^2*m*theta1d^2*cos(theta1 - theta2) + 12*l^2*m*theta1d^2*cos(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*cos(theta1 - theta2) + 18*g*l*m*sin(2*theta2) + 4*l^2*m*theta1d*theta2d*cos(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*cos(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)) - ((18*sin(2*theta2) + 6*sin(2*theta1 + 2*theta2) - 6*mu*sigma*cos(2*theta1 + 2*theta2))*(3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2)))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)^2)) - theta1d*((3*tau*sin(theta1 + theta2) - 81*tau*sin(theta1) - 27*tau*sin(theta1 - theta2) + 9*tau*sin(theta1 + 2*theta2) - 2*l^2*m*theta1d^2*cos(theta1 + theta2) - 2*l^2*m*theta2d^2*cos(theta1 + theta2) + 54*l^2*m*theta1d^2*cos(theta1) + 18*l^2*m*theta1d^2*cos(theta1 - theta2) - 6*l^2*m*theta1d^2*cos(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*cos(theta1 - theta2) - 4*l^2*m*theta1d*theta2d*cos(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*cos(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)) - ((54*sin(2*theta1) - 6*sin(2*theta1 + 2*theta2) - 54*mu*sigma*cos(2*theta1) + 6*mu*sigma*cos(2*theta1 + 2*theta2))*(3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2)))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)^2)) + (2*l*m*theta1dd*(theta1d*sin(theta1 + theta2) + theta2d*sin(theta1 + theta2) - 27*theta1d*sin(theta1) - 9*theta1d*sin(theta1 - theta2) + 3*theta1d*sin(theta1 + 2*theta2) - 9*theta2d*sin(theta1 - theta2)))/(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41) - (2*l*m*theta2dd*(theta1d + theta2d)*(9*sin(theta1 - theta2) - sin(theta1 + theta2)))/(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41);

end