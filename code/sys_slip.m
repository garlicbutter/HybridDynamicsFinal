function dXdt=sys_slip(t,X)

m=0.3;
g=10;
l=0.15;
dXdt = zeros(8,1);
mu = 0.3;
sgn_slip = -1;

x = X(1);
y = X(2);
theta_1 = X(3);
theta_2 = X(4);

dXdt(1) = X(5); x_d = X(5);
dXdt(2) = X(6); y_d = X(6);
dXdt(3) = X(7); theta_1d = X(7);
dXdt(4) = X(8); theta_2d= X(8);

tau=tau_calc(t,X);

dXdt(5) = (9*tau*sin(3*theta_1 + 2*theta_2) + 60*tau*sin(theta_1 + theta_2) + 24*tau*sin(theta_1) - 9*tau*sin(theta_1 - theta_2) + 9*tau*sin(theta_1 + 2*theta_2) + 27*tau*sin(3*theta_1 + theta_2) + 44*l^2*m*theta_1d^2*cos(theta_1 + theta_2) + 44*l^2*m*theta_2d^2*cos(theta_1 + theta_2) - 3*g*l*m*sin(2*theta_1 + 2*theta_2) - 9*mu*sgn_slip*tau*cos(3*theta_1 + 2*theta_2) - 92*l^2*m*theta_1d^2*cos(theta_1) + 12*mu*sgn_slip*tau*cos(theta_1 + theta_2) - 6*l^2*m*theta_1d^2*cos(theta_1 - theta_2) + 30*l^2*m*theta_1d^2*cos(theta_1 + 2*theta_2) - 6*l^2*m*theta_2d^2*cos(theta_1 - theta_2) + 18*l^2*m*theta_1d^2*cos(3*theta_1 + theta_2) + 18*l^2*m*theta_2d^2*cos(3*theta_1 + theta_2) + 54*mu*sgn_slip*tau*cos(theta_1) + 27*mu*sgn_slip*tau*cos(theta_1 - theta_2) - 9*mu*sgn_slip*tau*cos(theta_1 + 2*theta_2) - 27*mu*sgn_slip*tau*cos(3*theta_1 + theta_2) + 6*l^2*m*theta_1d^2*cos(3*theta_1 + 2*theta_2) + 27*g*l*m*sin(2*theta_1) + 9*g*l*m*sin(2*theta_2) + 88*l^2*m*theta_1d*theta_2d*cos(theta_1 + theta_2) - g*l*m*mu*sgn_slip - 12*l^2*m*theta_1d*theta_2d*cos(theta_1 - theta_2) + 36*l^2*m*theta_1d*theta_2d*cos(3*theta_1 + theta_2) - 16*l^2*m*mu*sgn_slip*theta_1d^2*sin(theta_1 + theta_2) - 16*l^2*m*mu*sgn_slip*theta_2d^2*sin(theta_1 + theta_2) - 36*l^2*m*mu*sgn_slip*theta_1d^2*sin(theta_1) + 18*l^2*m*mu*sgn_slip*theta_1d^2*sin(theta_1 - theta_2) - 6*l^2*m*mu*sgn_slip*theta_1d^2*sin(theta_1 + 2*theta_2) + 18*l^2*m*mu*sgn_slip*theta_2d^2*sin(theta_1 - theta_2) + 18*l^2*m*mu*sgn_slip*theta_1d^2*sin(3*theta_1 + theta_2) + 18*l^2*m*mu*sgn_slip*theta_2d^2*sin(3*theta_1 + theta_2) - 27*g*l*m*mu*sgn_slip*cos(2*theta_1) + 9*g*l*m*mu*sgn_slip*cos(2*theta_2) + 6*l^2*m*mu*sgn_slip*theta_1d^2*sin(3*theta_1 + 2*theta_2) + 3*g*l*m*mu*sgn_slip*cos(2*theta_1 + 2*theta_2) - 32*l^2*m*mu*sgn_slip*theta_1d*theta_2d*sin(theta_1 + theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*sin(theta_1 - theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*sin(3*theta_1 + theta_2))/(2*l*m*(27*cos(2*theta_1) - 9*cos(2*theta_2) - 3*cos(2*theta_1 + 2*theta_2) + 27*mu*sgn_slip*sin(2*theta_1) - 3*mu*sgn_slip*sin(2*theta_1 + 2*theta_2) + 41));
dXdt(6) =  -(9*tau*cos(3*theta_1 + 2*theta_2) + 72*tau*cos(theta_1 + theta_2) + 78*tau*cos(theta_1) + 45*tau*cos(theta_1 - theta_2) + 9*tau*cos(theta_1 + 2*theta_2) + 27*tau*cos(3*theta_1 + theta_2) + 81*g*l*m - 9*g*l*m*cos(2*theta_1 + 2*theta_2) - 60*l^2*m*theta_1d^2*sin(theta_1 + theta_2) - 60*l^2*m*theta_2d^2*sin(theta_1 + theta_2) + 9*mu*sgn_slip*tau*sin(3*theta_1 + 2*theta_2) + 56*l^2*m*theta_1d^2*sin(theta_1) + 42*l^2*m*theta_1d^2*sin(theta_1 - theta_2) - 30*l^2*m*theta_1d^2*sin(theta_1 + 2*theta_2) + 42*l^2*m*theta_2d^2*sin(theta_1 - theta_2) - 18*l^2*m*theta_1d^2*sin(3*theta_1 + theta_2) - 18*l^2*m*theta_2d^2*sin(3*theta_1 + theta_2) + 27*mu*sgn_slip*tau*sin(theta_1 - theta_2) + 9*mu*sgn_slip*tau*sin(theta_1 + 2*theta_2) + 27*mu*sgn_slip*tau*sin(3*theta_1 + theta_2) + 81*g*l*m*cos(2*theta_1) - 9*g*l*m*cos(2*theta_2) - 6*l^2*m*theta_1d^2*sin(3*theta_1 + 2*theta_2) - 120*l^2*m*theta_1d*theta_2d*sin(theta_1 + theta_2) + 84*l^2*m*theta_1d*theta_2d*sin(theta_1 - theta_2) - 36*l^2*m*theta_1d*theta_2d*sin(3*theta_1 + theta_2) - 18*l^2*m*mu*sgn_slip*theta_1d^2*cos(theta_1 - theta_2) - 6*l^2*m*mu*sgn_slip*theta_1d^2*cos(theta_1 + 2*theta_2) - 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(theta_1 - theta_2) + 18*l^2*m*mu*sgn_slip*theta_1d^2*cos(3*theta_1 + theta_2) + 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(3*theta_1 + theta_2) + 6*l^2*m*mu*sgn_slip*theta_1d^2*cos(3*theta_1 + 2*theta_2) + 81*g*l*m*mu*sgn_slip*sin(2*theta_1) - 9*g*l*m*mu*sgn_slip*sin(2*theta_2) - 9*g*l*m*mu*sgn_slip*sin(2*theta_1 + 2*theta_2) - 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(theta_1 - theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(3*theta_1 + theta_2))/(2*l*m*(27*cos(2*theta_1) - 9*cos(2*theta_2) - 3*cos(2*theta_1 + 2*theta_2) + 27*mu*sgn_slip*sin(2*theta_1) - 3*mu*sgn_slip*sin(2*theta_1 + 2*theta_2) + 41));
dXdt(7) = (42*l^2*m*theta_1d^2*sin(theta_2) - 9*tau*cos(2*theta_1 + 2*theta_2) - 45*tau*cos(theta_2) - 27*tau*cos(2*theta_1 + theta_2) - 9*mu*sgn_slip*tau*sin(2*theta_1 + 2*theta_2) - 39*tau + 42*l^2*m*theta_2d^2*sin(theta_2) - 81*g*l*m*cos(theta_1) + 18*l^2*m*theta_1d^2*sin(2*theta_1 + theta_2) + 18*l^2*m*theta_2d^2*sin(2*theta_1 + theta_2) + 27*mu*sgn_slip*tau*sin(theta_2) + 9*g*l*m*cos(theta_1 + 2*theta_2) + 54*l^2*m*theta_1d^2*sin(2*theta_1) + 18*l^2*m*theta_1d^2*sin(2*theta_2) - 27*mu*sgn_slip*tau*sin(2*theta_1 + theta_2) + 54*l^2*m*mu*sgn_slip*theta_1d^2 + 84*l^2*m*theta_1d*theta_2d*sin(theta_2) + 36*l^2*m*theta_1d*theta_2d*sin(2*theta_1 + theta_2) + 18*l^2*m*mu*sgn_slip*theta_1d^2*cos(theta_2) + 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(theta_2) - 18*l^2*m*mu*sgn_slip*theta_1d^2*cos(2*theta_1 + theta_2) - 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(2*theta_1 + theta_2) - 81*g*l*m*mu*sgn_slip*sin(theta_1) - 54*l^2*m*mu*sgn_slip*theta_1d^2*cos(2*theta_1) + 9*g*l*m*mu*sgn_slip*sin(theta_1 + 2*theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(theta_2) - 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(2*theta_1 + theta_2))/(2*l^2*m*(27*cos(2*theta_1) - 9*cos(2*theta_2) - 3*cos(2*theta_1 + 2*theta_2) + 27*mu*sgn_slip*sin(2*theta_1) - 3*mu*sgn_slip*sin(2*theta_1 + 2*theta_2) + 41));
dXdt(8) = -(3*g*l*m*cos(theta_1 + theta_2) - 81*tau*cos(2*theta_1) - 9*tau*cos(2*theta_1 + 2*theta_2) - 90*tau*cos(theta_2) - 54*tau*cos(2*theta_1 + theta_2) - 9*mu*sgn_slip*tau*sin(2*theta_1 + 2*theta_2) - 150*tau + 120*l^2*m*theta_1d^2*sin(theta_2) + 42*l^2*m*theta_2d^2*sin(theta_2) - 81*g*l*m*cos(theta_1) + 36*l^2*m*theta_1d^2*sin(2*theta_1 + theta_2) + 18*l^2*m*theta_2d^2*sin(2*theta_1 + theta_2) - 27*g*l*m*cos(theta_1 - theta_2) + 9*g*l*m*cos(theta_1 + 2*theta_2) + 54*l^2*m*theta_1d^2*sin(2*theta_1) + 36*l^2*m*theta_1d^2*sin(2*theta_2) + 18*l^2*m*theta_2d^2*sin(2*theta_2) - 54*mu*sgn_slip*tau*sin(2*theta_1 + theta_2) + 6*l^2*m*theta_1d^2*sin(2*theta_1 + 2*theta_2) + 6*l^2*m*theta_2d^2*sin(2*theta_1 + 2*theta_2) - 81*mu*sgn_slip*tau*sin(2*theta_1) + 60*l^2*m*mu*sgn_slip*theta_1d^2 + 6*l^2*m*mu*sgn_slip*theta_2d^2 + 84*l^2*m*theta_1d*theta_2d*sin(theta_2) + 36*l^2*m*theta_1d*theta_2d*sin(2*theta_1 + theta_2) + 36*l^2*m*theta_1d*theta_2d*sin(2*theta_2) + 12*l^2*m*theta_1d*theta_2d*sin(2*theta_1 + 2*theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d^2*cos(theta_2) + 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(theta_2) + 3*g*l*m*mu*sgn_slip*sin(theta_1 + theta_2) - 36*l^2*m*mu*sgn_slip*theta_1d^2*cos(2*theta_1 + theta_2) - 18*l^2*m*mu*sgn_slip*theta_2d^2*cos(2*theta_1 + theta_2) + 12*l^2*m*mu*sgn_slip*theta_1d*theta_2d - 81*g*l*m*mu*sgn_slip*sin(theta_1) - 54*l^2*m*mu*sgn_slip*theta_1d^2*cos(2*theta_1) - 27*g*l*m*mu*sgn_slip*sin(theta_1 - theta_2) + 9*g*l*m*mu*sgn_slip*sin(theta_1 + 2*theta_2) - 6*l^2*m*mu*sgn_slip*theta_1d^2*cos(2*theta_1 + 2*theta_2) - 6*l^2*m*mu*sgn_slip*theta_2d^2*cos(2*theta_1 + 2*theta_2) + 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(theta_2) - 36*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(2*theta_1 + theta_2) - 12*l^2*m*mu*sgn_slip*theta_1d*theta_2d*cos(2*theta_1 + 2*theta_2))/(2*l^2*m*(27*cos(2*theta_1) - 9*cos(2*theta_2) - 3*cos(2*theta_1 + 2*theta_2) + 27*mu*sgn_slip*sin(2*theta_1) - 3*mu*sgn_slip*sin(2*theta_1 + 2*theta_2) + 41));
end