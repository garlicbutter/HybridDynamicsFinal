function [lam_n,lam_t,lam_n_slip,lam_n_slip_dot] = lam_calc(X,tau)

global sigma m g L mu
m=0.3;g=9.8;L=0.15;mu=0.3;
x = X(1);
y = X(2);
theta1 = X(3);
theta2 = X(4);
xd = X(5);
yd = X(6);
theta1d = X(7);
theta2d = X(8);

t2 = theta1+theta2;
t3 = L.^2;
t4 = theta1.*2.0;
t5 = theta2.*2.0;
t6 = theta1d.^2;
t7 = theta2d.^2;
t10 = -theta2;
t8 = cos(t5);
t9 = sin(t2);
t11 = t10+theta1;
t12 = sin(t11);
lam_n = (tau.*cos(t2).*-2.4e+1+tau.*cos(t11).*2.7e+1-L.*g.*m.*6.8e+1+m.*t3.*t6.*t9.*2.2e+1+m.*t3.*t7.*t9.*2.2e+1+m.*t3.*t6.*t12.*2.7e+1+m.*t3.*t7.*t12.*2.7e+1+L.*g.*m.*cos(t4).*(8.1e+1./2.0)-m.*t3.*t6.*sin(t2+theta2).*3.0+m.*t3.*t6.*sin(theta1).*1.5e+2-L.*g.*m.*cos(t2.*2.0).*(3.0./2.0)+L.*g.*m.*t8.*9.0+m.*t3.*t9.*theta1d.*theta2d.*4.4e+1+m.*t3.*t12.*theta1d.*theta2d.*5.4e+1)./(L.*(t8.*1.8e+1-6.7e+1));

t2 = theta1+theta2;
t3 = L.^2;
t4 = theta1.*2.0;
t5 = theta2.*2.0;
t6 = theta1d.^2;
t7 = theta2d.^2;
t9 = -theta2;
t8 = cos(t2);
t10 = t9+theta1;
t11 = cos(t10);
lam_t = (tau.*sin(t2).*4.8e+1-tau.*sin(t10).*5.4e+1+m.*t3.*t6.*t8.*4.4e+1+m.*t3.*t7.*t8.*4.4e+1+m.*t3.*t6.*t11.*5.4e+1+m.*t3.*t7.*t11.*5.4e+1-m.*t3.*t6.*cos(t2+theta2).*6.0-L.*g.*m.*sin(t4).*8.1e+1+m.*t3.*t6.*cos(theta1).*3.0e+2+L.*g.*m.*sin(t2.*2.0).*3.0+m.*t3.*t8.*theta1d.*theta2d.*8.8e+1+m.*t3.*t11.*theta1d.*theta2d.*1.08e+2)./(L.*(cos(t5).*1.8e+1-6.7e+1).*2.0);

t2 = theta1+theta2;
t3 = L.^2;
t4 = theta1.*2.0;
t5 = theta2.*2.0;
t6 = theta1d.^2;
t7 = theta2d.^2;
t10 = -theta2;
t8 = cos(t5);
t9 = sin(t2);
t11 = t10+theta1;
t12 = t2.*2.0;
t13 = sin(t11);
lam_n_slip = (tau.*cos(t2).*-1.5e+1+tau.*cos(t11).*2.7e+1-L.*g.*m.*8.9e+1+m.*t3.*t6.*t9.*1.3e+1+m.*t3.*t7.*t9.*1.3e+1+m.*t3.*t6.*t13.*2.7e+1+m.*t3.*t7.*t13.*2.7e+1-m.*t3.*t6.*sin(t2+theta2).*3.0+m.*t3.*t6.*sin(theta1).*1.23e+2+L.*g.*m.*t8.*9.0+m.*t3.*t9.*theta1d.*theta2d.*2.6e+1+m.*t3.*t13.*theta1d.*theta2d.*5.4e+1)./(L.*(t8.*1.8e+1-cos(t4).*8.1e+1+cos(t12).*3.0-mu.*sigma.*sin(t4).*8.1e+1+mu.*sigma.*sin(t12).*3.0-1.36e+2));

% theta dd
t2 = cos(theta1);
t3 = cos(theta2);
t4 = sin(theta1);
t5 = sin(theta2);
t6 = theta1+theta2;
t7 = L.^2;
t8 = theta1.*2.0;
t9 = theta2.*2.0;
t10 = theta1d.^2;
t11 = theta2d.^2;
t17 = 1.0./m;
t18 = -theta2;
t12 = cos(t8);
t13 = cos(t9);
t14 = sin(t8);
t15 = sin(t9);
t16 = 1.0./t7;
t19 = t6+theta2;
t20 = t6+theta1;
t25 = t18+theta1;
t26 = t3.*tau.*4.5e+1;
t27 = t6.*2.0;
t34 = mu.*sigma.*t5.*tau.*2.7e+1;
t35 = L.*g.*m.*t2.*1.17e+2;
t40 = L.*g.*m.*mu.*sigma.*t4.*1.17e+2;
t43 = m.*t5.*t7.*t11.*5.7e+1;
t45 = m.*t5.*t7.*theta1d.*theta2d.*1.14e+2;
t49 = m.*mu.*sigma.*t3.*t7.*theta1d.*theta2d.*5.4e+1;
t52 = m.*mu.*sigma.*t3.*t7.*t11.*2.7e+1;
t21 = cos(t19);
t22 = cos(t20);
t23 = sin(t19);
t24 = sin(t20);
t28 = t13.*1.8e+1;
t29 = -t26;
t30 = cos(t27);
t31 = sin(t27);
t33 = t12.*8.1e+1;
t36 = -t35;
t37 = mu.*sigma.*t14.*8.1e+1;
t44 = -t40;
t55 = m.*t7.*t10.*t14.*8.1e+1;
t61 = m.*mu.*sigma.*t7.*t10.*t12.*-8.1e+1;
t32 = -t28;
t38 = t30.*3.0;
t39 = t22.*tau.*2.7e+1;
t46 = L.*g.*m.*t21.*9.0;
t47 = mu.*sigma.*t31.*3.0;
t48 = mu.*sigma.*t24.*tau.*2.7e+1;
t53 = L.*g.*m.*mu.*sigma.*t23.*9.0;
t54 = m.*t7.*t24.*theta1d.*theta2d.*5.4e+1;
t56 = m.*t7.*t11.*t24.*2.7e+1;
t57 = m.*mu.*sigma.*t7.*t22.*theta1d.*theta2d.*5.4e+1;
t58 = m.*mu.*sigma.*t7.*t10.*t33;
t59 = m.*mu.*sigma.*t7.*t11.*t22.*2.7e+1;
t41 = -t38;
t42 = -t39;
t50 = -t47;
t51 = -t48;
t60 = -t57;
t62 = -t59;
t63 = t32+t33+t37+t41+t50+1.36e+2;
t64 = 1.0./t63;
out1 = [t16.*t17.*t64.*(t29+t34+t36+t42+t43+t44+t45+t46+t49+t51+t52+t53+t54+t55+t56+t60+t61+t62+m.*t5.*t7.*t10.*5.7e+1+m.*t7.*t10.*t15.*1.8e+1+m.*t7.*t10.*t24.*2.7e+1+m.*mu.*sigma.*t7.*t10.*8.1e+1+m.*mu.*sigma.*t3.*t7.*t10.*2.7e+1-m.*mu.*sigma.*t7.*t10.*t22.*2.7e+1);-t16.*t17.*t64.*(t29+t34+t36+t42+t43+t44+t45+t46+t49+t51+t52+t53+t54+t55+t56+t60+t61+t62-tau.*1.23e+2-t12.*tau.*8.1e+1+m.*t5.*t7.*t10.*1.5e+2+m.*t7.*t10.*t15.*3.6e+1+m.*t7.*t11.*t15.*1.8e+1+m.*t7.*t10.*t24.*3.6e+1+m.*t7.*t10.*t31.*3.0+m.*t7.*t11.*t31.*3.0-mu.*sigma.*t14.*tau.*8.1e+1+L.*g.*m.*cos(t6).*1.5e+1-L.*g.*m.*cos(t25).*2.7e+1+m.*mu.*sigma.*t7.*t10.*8.4e+1+m.*mu.*sigma.*t7.*t11.*3.0+m.*t7.*t15.*theta1d.*theta2d.*3.6e+1+m.*t7.*t31.*theta1d.*theta2d.*6.0+m.*mu.*sigma.*t3.*t7.*t10.*3.6e+1-m.*mu.*sigma.*t7.*t10.*t22.*3.6e+1-m.*mu.*sigma.*t7.*t10.*t30.*3.0-m.*mu.*sigma.*t7.*t11.*t30.*3.0+m.*mu.*sigma.*t7.*theta1d.*theta2d.*6.0+L.*g.*m.*mu.*sigma.*sin(t6).*1.5e+1-L.*g.*m.*mu.*sigma.*sin(t25).*2.7e+1-m.*mu.*sigma.*t7.*t30.*theta1d.*theta2d.*6.0)];
theta1dd = out1(1);
theta2dd = out1(2);

t2 = sin(theta1);
t3 = theta1+theta2;
t4 = L.^2;
t5 = theta1.*2.0;
t6 = theta2.*2.0;
t7 = theta1d.^2;
t8 = theta2d.^2;
t13 = 1.0./L;
t16 = -theta2;
t24 = L.*g.*m.*8.9e+1;
t9 = cos(t5);
t10 = cos(t6);
t11 = sin(t5);
t12 = sin(t6);
t14 = cos(t3);
t15 = sin(t3);
t17 = t3+theta2;
t20 = t16+theta1;
t21 = t3.*2.0;
t28 = -t24;
t47 = m.*t2.*t4.*t7.*1.23e+2;
t18 = cos(t17);
t19 = sin(t17);
t22 = cos(t20);
t23 = sin(t20);
t25 = t10.*1.8e+1;
t26 = cos(t21);
t27 = sin(t21);
t29 = t14.*tau.*1.5e+1;
t30 = t15.*tau.*1.5e+1;
t32 = t9.*8.1e+1;
t34 = mu.*sigma.*t11.*8.1e+1;
t35 = L.*g.*m.*t10.*9.0;
t41 = m.*t4.*t15.*theta1d.*2.6e+1;
t42 = m.*t4.*t15.*theta2d.*2.6e+1;
t45 = m.*t4.*t14.*theta1d.*theta2d.*2.6e+1;
t49 = m.*t4.*t7.*t15.*1.3e+1;
t50 = m.*t4.*t8.*t15.*1.3e+1;
t51 = m.*t4.*t7.*t14.*1.3e+1;
t52 = m.*t4.*t8.*t14.*1.3e+1;
t31 = -t25;
t33 = -t29;
t36 = t26.*3.0;
t37 = t27.*6.0;
t39 = t22.*tau.*2.7e+1;
t40 = t23.*tau.*2.7e+1;
t43 = mu.*sigma.*t26.*6.0;
t44 = mu.*sigma.*t27.*3.0;
t46 = t41.*theta2d;
t53 = m.*t4.*t23.*theta1d.*5.4e+1;
t54 = m.*t4.*t23.*theta2d.*5.4e+1;
t55 = m.*t4.*t7.*t19.*3.0;
t57 = m.*t4.*t22.*theta1d.*theta2d.*5.4e+1;
t59 = m.*t4.*t7.*t22.*2.7e+1;
t60 = m.*t4.*t8.*t22.*2.7e+1;
t61 = m.*t4.*t7.*t23.*2.7e+1;
t62 = m.*t4.*t8.*t23.*2.7e+1;
t38 = -t36;
t48 = -t44;
t56 = -t55;
t58 = t53.*theta2d;
t63 = t31+t32+t34+t38+t48+1.36e+2;
t66 = t28+t33+t35+t39+t46+t47+t49+t50+t56+t58+t61+t62;
t64 = 1.0./t63;
t65 = t64.^2;
lam_n_slip_dot = -theta1d.*(t13.*t64.*(t30-t40+t45+t51+t52+t57+t59+t60-m.*t4.*t7.*t18.*3.0+m.*t4.*t7.*cos(theta1).*1.23e+2)+t13.*t65.*t66.*(t11.*1.62e+2-t37+t43-mu.*sigma.*t9.*1.62e+2))-theta2d.*(t13.*t64.*(t30+t40+t45+t51+t52-t57-t59-t60-m.*t4.*t7.*t18.*6.0-L.*g.*m.*t12.*1.8e+1)-t13.*t65.*t66.*(t12.*3.6e+1+t37-t43))-t13.*t64.*theta1dd.*(t41+t42+t53+t54+m.*t2.*t4.*theta1d.*2.46e+2-m.*t4.*t19.*theta1d.*6.0)-t13.*t64.*theta2dd.*(t41+t42+t53+t54);
end