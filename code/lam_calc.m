function [lam_n_stick,lam_t_general,lam_n_slip,lam_ndot] = lam_calc(X,tau,theta1dd,theta2dd)

global sigma
m=0.3;g=9.8;l=0.15;mu=0.3;


x = X(1);
y = X(2);
theta1 = X(3);
theta2 = X(4);
xd = X(5);
yd = X(6);
theta1d = X(7);
theta2d = X(8);


lam_t_general = (21*tau*sin(theta1 + theta2) - 27*tau*sin(theta1) - 27*tau*sin(theta1 - theta2) + 9*tau*sin(theta1 + 2*theta2) + 10*l^2*m*theta1d^2*cos(theta1 + theta2) + 10*l^2*m*theta2d^2*cos(theta1 + theta2) + 3*g*l*m*sin(2*theta1 + 2*theta2) + 90*l^2*m*theta1d^2*cos(theta1) + 18*l^2*m*theta1d^2*cos(theta1 - theta2) - 6*l^2*m*theta1d^2*cos(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*cos(theta1 - theta2) - 27*g*l*m*sin(2*theta1) + 20*l^2*m*theta1d*theta2d*cos(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*cos(theta1 - theta2))/(2*l*(9*cos(2*theta2) - 23));
lam_n_stick = (27*tau*cos(theta1) - 21*tau*cos(theta1 + theta2) + 27*tau*cos(theta1 - theta2) - 9*tau*cos(theta1 + 2*theta2) - 41*g*l*m - 3*g*l*m*cos(2*theta1 + 2*theta2) + 10*l^2*m*theta1d^2*sin(theta1 + theta2) + 10*l^2*m*theta2d^2*sin(theta1 + theta2) + 90*l^2*m*theta1d^2*sin(theta1) + 18*l^2*m*theta1d^2*sin(theta1 - theta2) - 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*sin(theta1 - theta2) + 27*g*l*m*cos(2*theta1) + 9*g*l*m*cos(2*theta2) + 20*l^2*m*theta1d*theta2d*sin(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2))/(2*l*(9*cos(2*theta2) - 23));
lam_n_slip = (3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41));
lam_ndot = theta2d*((2*l^2*m*theta1d^2*cos(theta1 + theta2) - 27*tau*sin(theta1 - theta2) - 18*tau*sin(theta1 + 2*theta2) - 3*tau*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*cos(theta1 + theta2) + 18*l^2*m*theta1d^2*cos(theta1 - theta2) + 12*l^2*m*theta1d^2*cos(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*cos(theta1 - theta2) + 18*g*l*m*sin(2*theta2) + 4*l^2*m*theta1d*theta2d*cos(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*cos(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)) - ((18*sin(2*theta2) + 6*sin(2*theta1 + 2*theta2) - 6*mu*sigma*cos(2*theta1 + 2*theta2))*(3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2)))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)^2)) - theta1d*((3*tau*sin(theta1 + theta2) - 81*tau*sin(theta1) - 27*tau*sin(theta1 - theta2) + 9*tau*sin(theta1 + 2*theta2) - 2*l^2*m*theta1d^2*cos(theta1 + theta2) - 2*l^2*m*theta2d^2*cos(theta1 + theta2) + 54*l^2*m*theta1d^2*cos(theta1) + 18*l^2*m*theta1d^2*cos(theta1 - theta2) - 6*l^2*m*theta1d^2*cos(theta1 + 2*theta2) + 18*l^2*m*theta2d^2*cos(theta1 - theta2) - 4*l^2*m*theta1d*theta2d*cos(theta1 + theta2) + 36*l^2*m*theta1d*theta2d*cos(theta1 - theta2))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)) - ((54*sin(2*theta1) - 6*sin(2*theta1 + 2*theta2) - 54*mu*sigma*cos(2*theta1) + 6*mu*sigma*cos(2*theta1 + 2*theta2))*(3*tau*cos(theta1 + theta2) - 81*tau*cos(theta1) - 27*tau*cos(theta1 - theta2) + 9*tau*cos(theta1 + 2*theta2) + 41*g*l*m + 2*l^2*m*theta1d^2*sin(theta1 + theta2) + 2*l^2*m*theta2d^2*sin(theta1 + theta2) - 54*l^2*m*theta1d^2*sin(theta1) - 18*l^2*m*theta1d^2*sin(theta1 - theta2) + 6*l^2*m*theta1d^2*sin(theta1 + 2*theta2) - 18*l^2*m*theta2d^2*sin(theta1 - theta2) - 9*g*l*m*cos(2*theta2) + 4*l^2*m*theta1d*theta2d*sin(theta1 + theta2) - 36*l^2*m*theta1d*theta2d*sin(theta1 - theta2)))/(2*l*(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41)^2)) + (2*l*m*theta1dd*(theta1d*sin(theta1 + theta2) + theta2d*sin(theta1 + theta2) - 27*theta1d*sin(theta1) - 9*theta1d*sin(theta1 - theta2) + 3*theta1d*sin(theta1 + 2*theta2) - 9*theta2d*sin(theta1 - theta2)))/(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41) - (2*l*m*theta2dd*(theta1d + theta2d)*(9*sin(theta1 - theta2) - sin(theta1 + theta2)))/(27*cos(2*theta1) - 9*cos(2*theta2) - 3*cos(2*theta1 + 2*theta2) + 27*mu*sigma*sin(2*theta1) - 3*mu*sigma*sin(2*theta1 + 2*theta2) + 41);

end